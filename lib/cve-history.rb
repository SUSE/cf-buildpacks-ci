# encoding: utf-8
require 'yaml'
require 'pry'

class CVEHistory
  attr_accessor :cves_dir

  # def initialize(cve_dir)
  #   @cves_dir = cve_dir
  # end

  def self.read_yaml_cves(cves_dir, yaml_filename)
    file_path = File.join(cves_dir, yaml_filename)

    if File.exist? file_path
      YAML.load_file("#{cves_dir}/#{yaml_filename}") || []
    else
      File.open(file_path, 'w') { |handle| handle.write([].to_yaml) }
      []
    end
  end

  def self.write_yaml_cves(cve_list, yaml_path)
    raise 'received invalid CVE list to write' unless cve_list.is_a?(Array)
    raise "file '#{yaml_path}' not found" unless File.exist? yaml_path
    File.open(yaml_path, 'w') { |handle| handle.write(cve_list.to_yaml) }
  end
end
